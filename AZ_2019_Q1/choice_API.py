import sys

sys.path.append('/mnf/mfs')

from work_whs.loc_lib.pre_load import *
from EmQuantAPI import *

loginResult = c.start("ForceLogin=1")

# file_name = '现货价格'
# data = c.edb("EMI01567119,EMI00057281,EMI00057282,EMI00057283,EMI00057284,EMI00057285,EMI00057286,EMI00057287,"
#              "EMI00057288,EMI00057289,EMI00057290,EMI00057291,EMI00057292,EMI00057293,EMI00057294,EMI00057295,"
#              "EMI00057296,EMI00057297,EMI00057298,EMI00057299,EMI00057300,EMI00057301,EMI00057302,EMI00057303,"
#              "EMI00057304,EMI00057305,EMI00057306,EMI01567094,EMI01567095,EMI01567096,EMI01567097,EMI01567098,"
#              "EMI01567099,EMI01567100,EMI01567101,EMI01567102,EMI01567103,EMI01567104,EMI01567105,EMI01567106,"
#              "EMI01567107,EMI01567108,EMI01567109,EMI01567110,EMI01567111,EMI01567112,EMI01567113,EMI01567114,"
#              "EMI01567115,EMI01567116,EMI01567117,EMI01567118", "IsLatest=0,StartDate=2011-01-01,EndDate=2019-04-22")
# for key in data.Data.keys():
#     value = data.Data[key]
#     data.Data[key] = value[0]
#
# target_df = pd.DataFrame.from_dict(data.Data)
# target_df.index = pd.to_datetime(data.Dates)
# target_df.to_csv('/mnt/mfs/DAT_FUT/Inventory/RB/Spot.csv', sep='|')

# file_name = '方坯'
# data = c.edb("EMI00055998,EMI00055981,EMI00055982,EMI00055983,EMI00055984,EMI00055985,EMI00055986,EMI00055987,"
#              "EMI00055988,EMI00055989,EMI00055990,EMI00055991,EMI00055992,EMI00055994,EMI00055995,EMI00055996,"
#              "EMI00055997", "IsLatest=0,StartDate=2011-01-01,EndDate=2019-04-22")

# file_name = '生铁'
# data = c.edb("EMI00056121,EMI00056102,EMI00056103,EMI00056104,EMI00056105,EMI00056106,EMI00056107,EMI00056108,"
#              "EMI00056109,EMI00056110,EMI00056111,EMI00056112,EMI00056113,EMI00056114,EMI00056115,EMI00056116,"
#              "EMI00056117,EMI00056119,EMI00056120", "IsLatest=0,StartDate=2011-01-01,EndDate=2019-04-22")

# file_name = '仓单库存'
# data = c.edb("EMI00064272", "IsLatest=0,StartDate=2011-01-01,EndDate=2019-04-22")

# file_name = '铁矿石1'
# code_list = "EMI00232536,EMI00055606,EMI00055607,EMI00055610,EMI00055605,EMI00055608,EMI00232528," \
#             "EMI00232529,EMI00232530,EMI00232531,EMI00232532,EMI00232533,EMI00232534,EMI00232535," \
#             "EMI00232539,EMI00055613,EMI00232526,EMI00232520,EMI00232521,EMI00232522,EMI00232523," \
#             "EMI00232524,EMI00232525,EMI00055633,EMI00055629,EMI00232541,EMI00055625,EMI00055622," \
#             "EMI00055624,EMI00055623,EMI00232547,EMI00232545,EMI00055643,EMI00055642,EMI00055644," \
#             "EMI00232546,EMI00232555,EMI00232549,EMI00232550,EMI00232551,EMI00232552,EMI00232553,"

# file_name = '铁矿石2'
# code_list = "EMI00232554,EMI00055645,EMI00232557,EMI00232562,EMI00055648,EMI00055647,EMI00055650," \
#             "EMI00055651,EMI00232558,EMI00232559,EMI00232560,EMI00232561,EMI00055661,EMI00055659," \
#             "EMI00232579,EMI00232563,EMI00232564,EMI00232565,EMI00232566,EMI00232567,EMI00232568," \
#             "EMI00232569,EMI00232570,EMI00232571,EMI00055666,EMI00055667,EMI00055665,EMI00232572," \
#             "EMI00232573,EMI00232574,EMI00232575,EMI00232576,EMI00232577,EMI00232578,EMI00232580," \
#             "EMI00055670,EMI00232583,EMI00055671,EMI00055675,EMI00055672,EMI00232585,EMI00232582," \
#             "EMI00232588,EMI00055679,EMI00055676,EMI00055678,EMI00055677,EMI00232587,EMI00232593," \
#             "EMI00232590,EMI00232591,EMI00232592,EMI00232599,EMI00055681,EMI00055682,EMI00055680," \
#             "EMI00232595,EMI00232596,EMI00232597,EMI00232598"
# file_name = '铁矿石:市场价'
# code_list = "EMI00055603,EMI00055578,EMI00055579,EMI00055580,EMI00055586,EMI00055588,EMI00055589," \
#             "EMI00055593,EMI00055594,EMI00055595,EMI00055597,EMI00055598"

# file_name = '废钢'
# code_list = "EMI00056138,EMI00056123,EMI00056124,EMI00056125,EMI00056126,EMI00056127,EMI00056128,EMI00056129," \
#             "EMI00056130,EMI00056131,EMI00056132,EMI00056133,EMI00056134,EMI00056135,EMI00056141,EMI00056137," \
#             "EMI00056143,EMI00056140,EMI00056136,EMI00056142"

# file_name = '废钢'
# code_list = "EMI00056138,EMI00056123,EMI00056124,EMI00056125,EMI00056126,EMI00056127,EMI00056128,EMI00056129," \
#             "EMI00056130,EMI00056131,EMI00056132,EMI00056133,EMI00056134,EMI00056135,EMI00056141,EMI00056137," \
#             "EMI00056143,EMI00056140,EMI00056136,EMI00056142"
#
# file_name = '涂镀'
# code_list = 'EMI00057490,EMI00057446,EMI00057447,EMI00057448,EMI00057449,EMI00057450,EMI00057451,EMI00057452,' \
#             'EMI00057453,EMI00057454,EMI00057455,EMI00057456,EMI00057457,EMI00057458,EMI00057459,EMI00057460,' \
#             'EMI00057461,EMI00057463,EMI00057464,EMI00057465,EMI00057466,EMI00057467,EMI00057468,EMI00057469,' \
#             'EMI00057470,EMI00057471,EMI00057472,EMI00057473,EMI00057474,EMI00057475,EMI00057476,EMI00057477,' \
#             'EMI00057479,EMI00057480,EMI00057481,EMI00057482,EMI00057484,EMI00057485,EMI00057486,EMI00057487,' \
#             'EMI00057488,EMI00057489'
#
file_name = '镀锌板'
code_list = 'EMI01629045,EMI01629033,EMI01629035,EMI01629036,EMI01629037,EMI01629038,EMI01629039,EMI01629040,' \
            'EMI01629041,EMI01629043,EMI01629044'

data = c.edb(code_list, "IsLatest=0,StartDate=2011-01-01,EndDate=2019-04-22")
for key in data.Data.keys():
    value = data.Data[key]
    data.Data[key] = value[0]


target_df = pd.DataFrame.from_dict(data.Data)
target_df.index = pd.to_datetime(data.Dates)
target_df.iloc[::-1].to_csv(f'/mnt/mfs/DAT_FUT/Inventory/RB/{file_name}.csv', sep='|')
logoutResult = c.stop()
